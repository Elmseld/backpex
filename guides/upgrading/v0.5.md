# Upgrading to v0.5

## Uploads: Item in `consume_upload/4` now contains changes

Previously, we passed the item without its changes to the `consume_upload/4` callback function. With 0.5, we now pass the persisted item (with its changes) to the function.

## Resource Actions now receive the data instead of the params

Previously, Resource Actions received the params from the form. With 0.5, Resource Actions now receive the data from the form. The data is a map that contains the casted and validated data from the form (received from [`Ecto.Changeset.apply_changes/2`](https://hexdocs.pm/ecto/Ecto.Changeset.html#apply_action/2)).

If you had a resource action like this:

```elixir
defmodule MyAppWeb.Admin.ResourceActions.Invite do
    # ...

    @impl Backpex.ResourceAction
    def handle(_socket, params) do
        # do something with params

        {:ok, "Success"}
    end
end
```

You should update it to:

```elixir
defmodule MyAppWeb.Admin.ResourceActions.Invite do
    # ...

    @impl Backpex.ResourceAction
    def handle(_socket, data) do
        # do something with data

        {:ok, "Success"}
    end
end
```

Note that the data is now casted. Therefore you now have atom keys instead of string keys.

## Item Actions now receive the data instead of the params

Previously, Item Actions received the params from the form. With 0.5, Item Actions now receive the data from the form. The data is a map that contains the casted and validated data from the form (received from [`Ecto.Changeset.apply_changes/2`](https://hexdocs.pm/ecto/Ecto.Changeset.html#apply_action/2)).

If you had an item action like this:

```elixir
defmodule MyAppWeb.Admin.ItemActions.Delete do
    # ...

    @impl Backpex.ItemAction
    def handle(socket, items, params) do
        # ...

        {:noreply, socket}
    end
end
```

You should update it to:

```elixir
defmodule MyAppWeb.Admin.ItemActions.Delete do
    # ...

    @impl Backpex.ItemAction
    def handle(socket, items, data) do
        # ...

        {:noreply, socket}
    end
end
```

Note that the data is now casted. Therefore you now have atom keys instead of string keys.
